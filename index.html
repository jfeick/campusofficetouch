<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
   	<meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Bauhaus Info Screen</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <link href="css/bootstrap.css" rel="stylesheet" />
    <link href="css/main.css" rel="stylesheet" />
    <link href="css/animations.css" rel="stylesheet" />
    <link href="css/font-awesome.css" rel="stylesheet" />
    <script src="js/jquery-1.11.0.js"></script>
    <link href="css/MetroJs.lt.css" rel="stylesheet" /> 
    <!-- <script src="js/bootstrap.min.js"></script> -->
    <script src="js/MetroJs.lt.js"></script>
    <script src="js/jsrender.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
    <script src="js/hammer.min.js"></script>
</head>

<body ondragstart="return false;" ondrop="return false;">
  <a href="index.html" class="logo logo-home"><img src="img/img-logo-home.svg"></a>
  <!-- 
  <ul class="language">
    <li><a class="lan-english"><span>ENG</span></a></li>
    <li><a class="lan-german"><span>DEU</span></a></li>
  </ul>
  -->
    <div class="container-fluid m-scene" id="main">
    	<div class="row scene_element scene_element--fadeindown">
  			<div class="col-md-5">
              <div class="tile-container">
                <div class="tag journal">
                    <span>Bauhaus.Journal </span>Online
                </div>
  				<div id="journal-tile" class="live-tile card" data-mode="carousel" data-direction="vertical" data-delay="10000">
            
  				</div>
              </div>
  			</div>
  			<div class="col-md-3">
                <div class="tile-container">
                <div class="tag calendar">
                  <span class="english">Calendar</span>
                  <span class="german">Veranstaltungskalender</span>
                </div>
  				<div id="calendar-tile" class="card live-tile" data-mode="carousel" data-direction="horizontal" data-delay="7500">
  				</div>
                </div>
  			</div>

  			<div class="col-md-4">

          <div class="ctn-map">
            <div class="tag map">
              <span class="english"> FIND YOUR WAY</span> 
              <span class="german">Lagepläne</span>
            </div> 
            <div id="mapid" class="index-map"> </div>
            <button class="locate-btn">
              <img src="img/icn-location.svg">
            </button>
            <a href="map.html" class="expand-btn">
              <img src="img/icn-expand.svg">
            </a>
          </div>
        </div>


<script >

  var mymap = L.map('mapid').setView([50.974897,11.328834], 16);

  L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
    maxZoom: 20,
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
      '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
      'Imagery © <a href="http://mapbox.com">Mapbox</a>',
    id: 'mapbox.streets'
  }).addTo(mymap);

  L.marker([50.974897,11.328834]).addTo(mymap)

     document.queryselector("button.locate-btn").addeventlistener("click", function() { mymap.setview([50.974897,11.328834], 16); }, true);
  //undefined

</script>

		</div>
		 <div class="row scene_element scene_element--fadeinup">
  			<div class="col-md-4">
          <div class="tile-container">
          <div class="tag piazza">
            <span> PINNWAND</span> PIAZZA
          </div>
          <div id="piazza-tile" class="live-tile card" data-mode="carousel" data-direction="horizontal" data-delay="6500">
  				<!-- <div class="card card-bottom"> -->
  					<div class="text-container">
  						<ul class="piazza-row">
  							<li>
  								<div class="piazzaimg"><img src="img/sample-img/img-piazzaindex1.png"></div>
  								<h3>2. November 2016</h3>
  								<h1>Clara Marie Landwehr: dtv-Atlas Baukunst abzugeben
								</h1>
                <a href="piazza.html" class="more"><span class="english">More...</span><span class="german">Mehr...</span></a>
  							</li>

  							<li>
  								<div class="piazzaimg"><img src="img/sample-img/img-piazzaindex2.png"></div>
  								<h3>2. November 2016</h3>
  								<h1>Lichthaus Kino: Morgen: Baldabiou live im Lichthaus
								</h1>
                <a href="piazza.html" class="more"><span class="english">More...</span><span class="german">Mehr...</span></a>
  							</li>
  						</ul>
  					</div>
  				</div>
          </div>
  			</div>
  			<div class="col-md-5">
            <div class="tile-container">
                <div class="tag showcase">
                  <span>Experiment.Bauhaus </span>Showcase
                </div>
  				<div id="showcase-tile" class="live-tile card card-bottom" data-mode="carousel" data-direction="vertical" data-delay="9500">
  					
  				</div>
            </div>
  			</div>
  			<div class="col-md-3">
  				<div class="card-social">
          <div class="noimg fb">
            <img src="img/icn-facebook.png">
          </div>
          <!--
  					<div class="socialtag facebook">
  						<img src="img/icn-facebook.svg">
  					</div>
  					<div class="socialimg"><img src="img/sample-img/img-facebookindex.png"></div>
            -->
  					<div class="text-container-social textfade">
  						<h2>@bauhaus.botschafter</h2>
						<p>Die Bauhaus-Universität Weimar unterstützt den Aufruf des Bürgerbündnis gegen Rechtsextremismus Weimar:</p>
  					</div>
  				</div>
  				<div class="card-social">
  					<div class="socialtag twitter">
  						<img src="img/icn-twitter.png">
  					</div>
            <div class="socialimg"><img src="img/sample-img/img-twitterindex.png"></div>
  					<div class="text-container-social textfade">
  						<h2>@bauhaus_uni</h2>
						<p>Intelligente #Bauwerke: Fakultät #Bauingenieurwesen der #BauhausUni erhält Förderung für ein #Sensorik-#Labor</p>
  					</div>
  				</div>
  				<div class="card-social card-bottom">
  					<div class="socialtag instagram">
  						<img src="img/icn-instagram.png">
  					</div>
  					<div class="socialimg"><img src="img/sample-img/img-instagramindex.png"></div>
  					<div class="text-container-social textfade">
  						<h2>@bauhaus_uni</h2>
  						<p>bauhaus_uniIn weniger als 2 Stunden startet das Internationale Bauhaus-Kolloquium an der...</p>
  					</div>
  				</div>
  			</div>
		</div>
	</div>
  </div>
    <!-- 
    <div class="row row-bottom">
      <div class="col-md-10 col-md-offset-1">
        <div class="bottom-container">
          <ul class="bottom-menu">
            <li><a href="index.html"><p><span class=""><span class="bold">Main</span> <br>Screen</span></p></a></li>
            <li><a href="journal.html" class="journal-menu"><p><span class="bold">Bauhaus.Journal</span> <br>Online</p></a></li>
            <li><a href="showcase.html"><p><span class="bold">Experiment.Bauhaus</span> <br>Showcase</p></a></li>
            <li><a href="calendar.html"><p><span class="english"><span class="bold">Calendar</span> <br>Upcoming Events</span> <span class="german"><span class="bold">Veranstaltungs </span><br>kalender</span></p></a></li>
            <li><a href="piazza.html"><p><span class="bold">Pinnwand</span> <br>Piazza</p></a></li>
            <li><a href="map.html"><p><span class="german"><span class="bold">Lagepläne </span><br> Dein Weg</span><span class="english"><span class="bold">Find</span> <br>Your Way</span></p></a></li>
          </ul>
        </div>
      </div>
    </div>
    -->

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> -->

    <script id="calendar-slide-template" type="text/x-jsrender">
      <div>
       <div class="text-container">
          <ul class="calendar-row">
            {{for pair tmpl='#calendar-slide-item-template'/}}}}
          </ul>
        </div>
      </div>
    </script>

    <script id="calendar-slide-item-template" type="text/x-jsrender">
    <a href="calendar.html?id={{:id}}" style="width:50%">
      <li class="calendar-event">
        <div class="calendar-title">
          <div class="date-calendar">
            <p class="weekday">{{:weekday}}</p>
            <p class="day">{{:day_of_month}}</p>
            <p class="month">{{:month}}</p>
          </div>
          <h1>{{:title}}</h1>
        </div>
        <ul class="calendar-list textfade" >
          {{:maininfo}}
        </ul>
        <!-- <a href="calendar.html?id={{:id}}" class="more"><span class="english">More...</span><span class="german">Mehr...</span></a> -->
      </li>
      </a>
    </script>

    <script id="showcase-slide-template" type="text/x-jsrender">
        <a href="showcase.html?id={{:id}}">
      <div>
        <div class="img-card">{{include images[0]}}<img src="showcase/thumbs/big/{{>path}}{{/include}}"></div>
        <div class="text-container">
          <h1>{{:title}}</h1>
          <h3>{{:author}}</h3>
          <span id="showcase-teaser" class="textfade">{{:description}}</div>
        </div>
      </div>
        </a>
    </script>

    <script id="piazza-slide-template" type="text/x-jsrender">
     <div>
      <div class="text-container">
        <ul class="piazza-row">
           {{for pair tmpl='#piazza-slide-item-template'/}}
        </ul>
      </div>
     </div>
    </script>
    <script id="piazza-slide-item-template" type="text/x-jsrender">
    <a href="piazza.html?id={{:id}}">
          <li>
            <div class="piazzaimg">{{if image_urls.length }}<img src="piazza/thumbs/small/{{for images tmpl='#piazza-image-template'/}}">{{/if}}</div>
            <h3>{{:german_date}} um {{:time}}</h3>
            <h1>{{:author}}: {{:title}}
            </h1>
          </li>
        </a>
    </script>
    <script id="piazza-image-template" type="text/x-jsrender">{{>path}}</script>

    <script id="journal-slide-template" type="text/x-jsrender">
      <div>
        <a href="journal.html?id={{:id}}">
        <div class="img-card"><img src="journal/thumbs/big/{{for images tmpl='#journal-image-template'/}}"></div>
        <div class="text-container">
            <h3>{{:date}}</h3>
            <h1>{{:title}}</h1>
            <div id="journal-teaser" class="textfade">
            <p>{{:teaser_text}}</p>
            <!-- <a href="journal.html?id={{:id}}" class="seeall"><span class="english">More...</span><span class="german">Mehr...</span></a> -->
            </div>
        </div>
        </a>
      </div>
    </script>
    <script id="journal-image-template" type="text/x-jsrender">{{>path}}</script>
    <!-- Activate live tiles -->
    <script type="text/javascript">
      function Shuffle(o) {
        for(var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
        return o;
      };
      function getRandomSubarray(arr, size) {
        var shuffled = arr.slice(0), i = arr.length, temp, index;
        while (i--) {
            index = Math.floor((i + 1) * Math.random());
            temp = shuffled[index];
            shuffled[index] = shuffled[i];
            shuffled[i] = temp;
        }
        return shuffled.slice(0, size);
      }

      $.getJSON("./journal.json", function(json) {
        window.journal_data = json;
        $.each(window.journal_data, function(k, v) {
          v['id'] = k + 1;
        });
        Shuffle(window.journal_data);
        var template = $.templates("#journal-slide-template");
        var htmlOutput = template.render(json);
        $("#journal-tile").html(htmlOutput).liveTile();
      });

      $.getJSON("./piazza.json", function(json) {
        window.piazza_data = json;
        
        $.each(window.piazza_data, function(k, v) {
          v['id'] = k + 1;
        });
        //console.log(window.piazza_data);
        if (!Array.prototype.pair) {
          Array.prototype.pair = function () {
            var a = this.slice(), r = [];
            while (a.length > 0) {
              r.push({"pair": a.splice(0, 2)});
            }
            return r;
          };
        }
        //Shuffle(window.piazza_data);
        window.piazza_data = window.piazza_data.pair();
        //console.log(window.piazza_data);
        var template = $.templates("#piazza-slide-template");
        var htmlOutput = template.render(window.piazza_data);
        $("#piazza-tile").html(htmlOutput).liveTile();
      });

      $.getJSON("./showcase.json", function(json) {
        window.showcase_data = json;
        $.each(window.showcase_data, function(k, v) {
          v['id'] = k + 1;
        });
        window.showcase_data = getRandomSubarray(window.showcase_data, 60);
        //console.log(window.showcase_data);
        var template = $.templates('#showcase-slide-template');
        var htmlOutput = template.render(window.showcase_data);
        $("#showcase-tile").html(htmlOutput).liveTile();
      });

      $.getJSON("./calendar.json", function(json) {
        window.calendar_data = json;
        
        if (!Array.prototype.pair) {
          Array.prototype.pair = function () {
            var a = this.slice(), r = [];
            while (a.length > 0) {
              r.push({"pair": a.splice(0, 2)});
            }
            return r;
          };
        }
        window.calendar_data = window.calendar_data.pair();
        //console.log(window.piazza_data);
        //Shuffle(window.journal_data);
        var template = $.templates("#calendar-slide-template");
        var htmlOutput = template.render(window.calendar_data);
        $("#calendar-tile").html(htmlOutput).liveTile();

        //ret = $("li:has(ul.event-categories)");
        //ret.addClass("event-categories-fix");

        // Restructure list of event categories

        //console.log(ret);
      });

      // fix calendar Art line break

      // register Touch events

      var myElement = document.getElementById('journal-tile');
      var mc = new Hammer(myElement);
      mc.get('pan').set({ direction: Hammer.DIRECTION_VERTICAL });
      mc.on("pandown panup", function(ev) {
              //console.log(ev.type + " gesture detected.");
              if(ev.type === "pandown") {
                      console.log("prev");
                      $("#journal-tile").liveTile("goto", "prev");
              } else if(ev.type === "panup") {
                      console.log("next");
                      $("#journal-tile").liveTile("goto", "next");
              }
      });
      myElement = document.getElementById('calendar-tile');
      mc = new Hammer(myElement);
      mc.get('pan').set({ direction: Hammer.DIRECTION_HORIZONTAL });
      mc.on("panleft panright", function(ev) {
              //console.log(ev.type + " gesture detected.");
              if(ev.type === "panright") {
                      console.log("prev");
                      $("#calendar-tile").liveTile("goto", "prev");
              } else if(ev.type === "panleft") {
                      console.log("next");
                      $("#calendar-tile").liveTile("goto", "next");
              }
      });

      myElement = document.getElementById('piazza-tile');
      mc = new Hammer(myElement);
      mc.get('pan').set({ direction: Hammer.DIRECTION_HORIZONTAL });
      mc.on("panleft panright", function(ev) {
              //console.log(ev.type + " gesture detected.");
              if(ev.type === "panright") {
                      console.log("prev");
                      $("#piazza-tile").liveTile("goto", "prev");
              } else if(ev.type === "panleft") {
                      console.log("next");
                      $("#piazza-tile").liveTile("goto", "next");
              }
      });

      myElement = document.getElementById('showcase-tile');
      mc = new Hammer(myElement);
      mc.get('pan').set({ direction: Hammer.DIRECTION_HORIZONTAL });
      mc.on("panup pandown", function(ev) {
              //console.log(ev.type + " gesture detected.");
              if(ev.type === "pandown") {
                      console.log("prev");
                      $("#showcase-tile").liveTile("goto", "prev");
              } else if(ev.type === "panup") {
                      console.log("next");
                      $("#showcase-tile").liveTile("goto", "next");
              }
      });
    </script>

  </body>
</html>
